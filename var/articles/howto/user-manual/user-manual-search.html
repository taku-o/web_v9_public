.. vim:set expandtab ff=unix ft=rest :

..  vimエディタ・スターターマニュアル #5 （検索、置換）

..  vimエディタをはじめて扱う人が、だましだましvimエディタでの作業を開始できるようにするための、チュートリアルよりも小さな、しかし必要な情報は盛り込んだ、最小のユーザマニュアルを目指して作成したドキュメントです。
    このページでは、
    ビジュアルモード～
    テキストの検索～
    テキストの置換
    までを扱います。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen| unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
ビジュアルモード
================================================================================

ノーマルモードで :raw-html:`<kbd>v</kbd>` を押すと、vimエディタのモードがビジュアルモードになります。 |BR|
このビジュアルモードでカーソルを動かすと、
ビジュアルモードを開始した位置から、カーソルの位置までのテキストが選択されます。

.. image:: /dist/img/howto/user-manual/visualmode_select.jpg
    :alt:  テキストの選択

このテキストを選択した状態で :raw-html:`<kbd>y</kbd>` を押すと、選択したテキストをコピーします。 |BR|
これは通常のテキストエディタで、マウスで範囲を選択してのコピーと似た操作です。
マウスで範囲を選択する代わりに、ビジュアルモードで範囲を選択したのです。

この操作でコピーしたテキストは、通常のコピーと同じく、
ノーマルモードで :raw-html:`<kbd>p</kbd>` を押すことでペーストできます。

.. note::

    ビジュアルモードからノーマルモードに戻るには :raw-html:`<kbd>ESC</kbd>` キーを、 |BR|
    ノーマルモードからビジュアルモードにモードを変更するには :raw-html:`<kbd>v</kbd>` キーを |BR|
    押します。


選択したテキストのカット
-------------------------------------------------------------------------------

ビジュアルモードでテキストを選択した状態で、 :raw-html:`<kbd>y</kbd>` の代わりに :raw-html:`<kbd>d</kbd>` を押すと、
選択したテキストのカットができます。



================================================================================
テキストの検索
================================================================================

テキストを検索するには、ノーマルモードで :raw-html:`<kbd>/</kbd>` と入力します。 |BR|
:raw-html:`<kbd>/</kbd>` を押すと、検索ワードを入力できるようになるので、

.. image:: /dist/img/howto/user-manual/searchmode.jpg
    :alt:  検索開始

この状態で、検索ワードを入力して :raw-html:`<kbd>Enter</kbd>` キーを押すと、 |BR|
検索でヒットしたテキストの位置にカーソルが移動します。

.. image:: /dist/img/howto/user-manual/searchmode_input.jpg
    :alt:  検索ワード入力

.. note::

    検索を開始するには、ノーマルモードで :raw-html:`<kbd>/</kbd>` を押します。 |BR|
    その状態から、検索をせずに、ノーマルモードに戻るには :raw-html:`<kbd>ESC</kbd>` キーを押します。


検索に複数マッチ
-------------------------------------------------------------------------------

一回の検索に複数がヒットした場合は、ノーマルモードで :raw-html:`<kbd>n</kbd>` キーを押すと、 |BR|
検索でヒットした位置に、順にカーソルを移動できます。 |BR|
:raw-html:`<kbd>n</kbd>` の代わりに :raw-html:`<kbd>N</kbd>` を押すと、逆順にカーソルを移動していきます。

.. csv-table::
    :header: キー入力, 説明

    n, 検索にヒットした位置にカーソルを移動
    N, 検索にヒットした位置にカーソルを移動（逆順）

.. image:: /dist/img/howto/user-manual/searchmode_cursor_mv.jpg
    :alt:  検索後のカーソルの移動



================================================================================
テキストの置換
================================================================================

テキストを置換するには、コマンドラインモードで :raw-html:`<kbd>:substitute</kbd>` コマンドを使用します。 |BR|
:raw-html:`<kbd>:substitute</kbd>` コマンドは次のように使用します。 |BR|
（「:substitute」は長いので、「:s」で置換処理を実行する方がほとんどです。）

.. parsed-literal::
    :class: console

    :s/{置換するテキスト}/{置換後テキスト}/

.. image:: /dist/img/howto/user-manual/substitute.jpg
    :alt:  置換コマンドの実行

最も単純な、この形式のコマンドで置換処理を実行すると、 |BR|
一般的なテキストエディタの置換処理とは異なり、 |BR|
カーソルのある行の、最初にマッチしたテキストのみが置換されます。


置換処理の範囲とオプションの指定
-------------------------------------------------------------------------------

置換処理実行時に、置換処理の範囲と、置換処理のオプションを指定するには、
次のようにコマンドを実行します。

.. parsed-literal::
    :class: console

    :{コマンドの処理範囲}s/{置換するテキスト}/{置換後テキスト}/{オプション}

.. csv-table::
    :header: 範囲指定, 説明

    "\%", ファイル全体を置換処理の対象とする。
    "{行数A},{行数B}", 行数Aから、行数Bまでの範囲の行を置換対象とする。

.. csv-table::
    :header: オプション, 説明

    "g", その行でマッチしたテキスト全てを置換する
    "c", 処理を行う前に、置換処理をするかどうかを確認する。

一般的なテキストエディタの置換のような、
ファイル全体の、マッチした全てのテキストを対象とした置換を行うには、 |BR|
「%」の範囲指定と、「g」の検索オプションを使用して次のようにコマンドを実行します。

.. parsed-literal::
    :class: console

    :%s/{置換するテキスト}/{置換後テキスト}/g

.. image:: /dist/img/howto/user-manual/substitute_all.jpg
    :alt:  一般的なエディタのような置換コマンドの実行



================================================================================
ページリンク
================================================================================

#. `vimエディタ・スターターマニュアル #1 （ドキュメントの表記）`__
#. `vimエディタ・スターターマニュアル #2 （モードの切替）`__
#. `vimエディタ・スターターマニュアル #3 （カーソルの移動）`__
#. `vimエディタ・スターターマニュアル #4 （テキスト編集）`__
#. - `vimエディタ・スターターマニュアル #5 （検索、置換）`__
#. `vimエディタ・スターターマニュアル #6 （複数のバッファの管理）`__
#. `vimエディタ・スターターマニュアル #7 （ホームディレクトリのファイル構成）`__
#. `vimエディタ・スターターマニュアル #8 （設定ファイル）`__

__ /articles/howto/user-manual/user-manual-description.html
__ /articles/howto/user-manual/user-manual-mode.html
__ /articles/howto/user-manual/user-manual-motion.html
__ /articles/howto/user-manual/user-manual-editing.html
__ /articles/howto/user-manual/user-manual-search.html
__ /articles/howto/user-manual/user-manual-buffer.html
__ /articles/howto/user-manual/user-manual-user-dir.html
__ /articles/howto/user-manual/user-manual-config.html



