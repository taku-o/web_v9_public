.. vim:set expandtab ff=unix ft=rest :

..  vimエディタからクリップボードを利用する。

..  アプリケーション間のデータの受け渡しには、
    クリップボードという仕組みがよく利用されています。
    クリップボードを経由してデータを共有することにより、
    仕組みの違う各アプリケーションで、それぞれの得意能力を活かした
    データの編集が可能になります。
    当然、vimエディタでも、クリップボードを使用して
    他の専用アプリケーションで作成したデータを再編集したり、
    あるいは、vimエディタのパワフルな編集能力で作成したテキストデータを
    他のアプリケーションに渡すことができます。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

アプリケーション間のデータの受け渡しには、
クリップボードという仕組みがよく利用されています。 |BR|
クリップボードを経由してデータを共有することにより、
仕組みの違う各アプリケーションで、それぞれの得意能力を活かした
データの編集が可能になります。 |BR|
当然、vimエディタでも、クリップボードを使用して
他の専用アプリケーションで作成したデータを再編集したり、 |BR|
あるいは、vimエディタのパワフルな編集能力で作成したテキストデータを
他のアプリケーションに渡すことができます。



================================================================================
ショートカットキー入力によるクリップボードの操作
================================================================================

まず、何の知識も持たない方が
最も簡単にクリップボードのデータを扱う方法を紹介します。

Windows環境
--------------------------------------------------------------------------------

Windows環境のvimエディタでは、次のコマンドでクリップボードのデータを操作できます。 |BR|
この操作は、ノーマルモード、入力モード、コマンドラインモード、ビジュアルモード、
検索と全ての操作で使用可能です。

- :raw-html:`<kbd>Control</kbd>` キー + :raw-html:`<kbd>Insert</kbd>` キーでコピー
- :raw-html:`<kbd>Control</kbd>` キー + :raw-html:`<kbd>Delete</kbd>` キーでカット
- :raw-html:`<kbd>Shift</kbd>` キー + :raw-html:`<kbd>Delete</kbd>` キーでカット
- :raw-html:`<kbd>Shift</kbd>` キー + :raw-html:`<kbd>Insert</kbd>` キーでペースト

コピーする範囲、カットする範囲は、ビジュアルモードで選択したテキストの範囲となります。

.. image:: /dist/img/howto/editing/clipboard_selecttext.jpg
    :alt:  ビジュアルモードで選択してからコピー

.. csv-table:: Windows環境
    :header: キー入力, 機能, 説明

    Control-Insert,  コピー,   ビジュアルモードで選択したテキストをコピー。コピーしたテキストはクリップボードに入る。
    Control-Delete,  カット,   ビジュアルモードで選択したテキストをカット。カットしたテキストはクリップボードに入る。
    Shift-Delete, カット,   ビジュアルモードで選択したテキストをカット。カットしたテキストはクリップボードに入る。
    Shift-Insert, ペースト, クリップボードのテキストをペースト。


Mac OSX環境
--------------------------------------------------------------------------------

Mac OSX環境のvimエディタでは、
通常のアプリケーションのコピー、カット、ペーストの操作と同じ操作で、
コピー、カット、ペーストができます。 |BR|
ノーマルモード、入力モード、コマンドラインモード、ビジュアルモード、
検索と全ての操作で使用可能です。

- :raw-html:`<kbd>Command</kbd>` キー + :raw-html:`<kbd>c</kbd>` キーでコピー
- :raw-html:`<kbd>Command</kbd>` キー + :raw-html:`<kbd>x</kbd>` キーでカット
- :raw-html:`<kbd>Command</kbd>` キー + :raw-html:`<kbd>v</kbd>` キーでペースト

.. csv-table:: Mac OSX環境
    :header: キー入力, 機能, 説明

    Command-c, コピー,   ビジュアルモードで選択したテキストをコピー。コピーしたテキストはクリップボードに入る。
    Command-x, カット,   ビジュアルモードで選択したテキストをカット。カットしたテキストはクリップボードに入る。
    Command-v, ペースト, クリップボードのテキストをペースト。



================================================================================
メニューによるクリップボードの操作
================================================================================

GUI版vimエディタの場合、
「編集」メニューにある「切り取り(Ｔ)」「コピー(Ｃ)」「貼り付け(Ｐ)」を使用しても、
クリップボードを使用した編集処理ができます。 |BR|
この操作も、上で紹介した操作と同じく、ノーマルモード、入力モード、コマンドラインモード、
ビジュアルモード、検索と全ての操作で使用可能です。

.. image:: /dist/img/howto/editing/clipboard_menu.jpg
    :alt:  メニューでの操作



================================================================================
「\*レジスタ」によるクリップボードの操作
================================================================================

「\*レジスタ」
--------------------------------------------------------------------------------

クリップボードのデータは、vimエディタの「\*レジスタ」を使用すると参照できます。 |BR|
また、「\*レジスタ」にデータをセットすることで、クリップボードにデータをセットできます。

.. image:: /dist/img/howto/editing/clipboard_star_register.png
    :alt:  スターレジスタは、クリップボードとして扱える。

.. note::

    vimエディタの「clipboard」オプションに「unnamed」がセットされていない場合、 |BR|
    vimエディタでテキストを普通にyankすると、
    そのデータは「無名レジスタ」と呼ばれる場所に配置されます。 |BR|
    （ 無名レジスタ ≠ \*レジスタ ）


レジスタにデータをセットする
--------------------------------------------------------------------------------

「\*レジスタ」を使用してクリップボードにデータを入れる方法は、
通常のレジスタの操作と変わりません。 |BR|
「\*レジスタ」を指定し、ヤンク、もしくはカットを実行すると、
クリップボードにデータがセットされます。

.. parsed-literal::
    :class: console

    **1単語分のテキストをコピー。コピーしたテキストはクリップボードに入ります。**
    "\*yw
    
    **7行分のテキストをカット。カットしたテキストはクリップボードに入ります。**
    "\*7D

上のコマンド例のように、コマンド実行時に範囲を指定したり、 |BR|
ビジュアルモードで範囲を選択してから :raw-html:`<kbd>"*y</kbd>` と入力して、
「\*レジスタ」にデータをセットします。

.. image:: /dist/img/howto/editing/clipboard_put_start_register.jpg
    :alt:  ビジュアルモードで選択してからコピー


レジスタからデータを読み込む
--------------------------------------------------------------------------------

ノーマルモード、ビジュアルモード時に、
「\*レジスタ」からデータを読み込み、カーソル位置にペーストするには、
次のようにコマンドを実行します。

.. parsed-literal::
    :class: console

    **カーソル位置にクリップボードのテキストをペースト。**
    "\*p

ノーマルモード、ビジュアルモード以外の時は、
レジスタのデータを貼り付ける :raw-html:`<kbd>Control-r</kbd>` を使用すると良いでしょう。 |BR|
入力モード、コマンドラインモード、検索時に、 :raw-html:`<kbd>Control-r {レジスタの名前}</kbd>` と実行すると、
指定したレジスタのデータを貼り付けられます。

.. parsed-literal::
    :class: console

    **「\*レジスタ」のデータを出力**
    <C-r>\*

.. image:: /dist/img/howto/editing/clipboard_search_input_pre.jpg
    :alt:  検索時。クリップボードには「クリップボード」というテキストが入れられている

↓ 例えば、この状態で :raw-html:`<kbd>Control-r *</kbd>` と実行すると、その位置にレジスタ「\*」のデータを出力できます。

.. image:: /dist/img/howto/editing/clipboard_search_input.jpg
    :alt:  検索時。クリップボードのデータを出力



================================================================================
クリップボード関連の設定
================================================================================

vimエディタにはクリップボードに関する設定も用意されています。 |BR|
次に紹介する2つの機能は、vimエディタの設定ファイルに、その設定を書き込むと有効になります。


ビジュアルモードで選択したテキストが、クリップボードに入るようにする。
--------------------------------------------------------------------------------

次の設定をvimエディタの設定ファイルに書くと、
ビジュアルモードで選択したテキストがクリップボードに入るようになります。 |BR|
ビジュアルモードの選択範囲を変更した瞬間に、
その選択したテキストでクリップボードのデータが書き換えられていきます。

この機能を有効にする設定の書き方は、GUI版のvimエディタとそれ以外で違うので、
気をつけてください。

.. parsed-literal::
    :class: program

    **" GUI版vimエディタで、この機能を有効にするなら、この設定を追加する。**
    :set guioptions+=a
    
    **" GUI版でない場合は、こちらの設定を追加する。**
    :set clipboard+=autoselect


yankしたテキストが無名レジスタだけでなく、\*レジスタにも入るようにする。
--------------------------------------------------------------------------------

次の設定を有効にすると、通常、「無名レジスタ」に入る、
ヤンク、カットの操作で指定したテキストが、「\*レジスタ」にも入るようになります。 |BR|
「\*レジスタ」にデータを入れると、クリップボードにデータが入るので、 |BR|
vimエディタでヤンク、カットしたテキストを、
他のアプリケーションで即ペーストして使用できることになります。

.. parsed-literal::
    :class: program

    **" 無名レジスタに入るデータを、\*レジスタにも入れる。**
    :set clipboard+=unnamed



================================================================================
注意事項など
================================================================================

vimエディタでクリップボードを使用するには、
vimエディタが「+clipboard」でコンパイルされている必要があります。 |BR|
vimエディタのコンパイルオプションを確認するには、
vimエディタを起動して次のコマンドを実行してください。

.. parsed-literal::
    :class: console

    :version



