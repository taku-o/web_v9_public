.. vim:set expandtab ff=unix ft=rest :

..  vimエディタの印刷機能を使用する #1 （印刷機能の基本）

..  vimエディタの印刷機能に関する説明です。
    この記事ではvimエディタの印刷機能の基本的な項目について説明します。
    (Windows)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

vimエディタの印刷機能に関する説明です。 |BR|
この記事ではvimエディタの印刷機能の基本的な項目について説明します。



================================================================================
印刷機能の実行方法
================================================================================

vimエディタで印刷を行うには :raw-html:`<kbd>:hardcopy</kbd>` コマンドを実行するか、 |BR|
メニューから「印刷(P)」を選択します。

.. parsed-literal::
    :class: console

    **" 印刷ダイアログを表示する**
    :hardcopy

Windows環境の場合は :raw-html:`<kbd>:hardcopy</kbd>` コマンドを実行すると印刷ダイアログが表示されるので、 |BR|
そのダイアログから印刷を実行してください。

.. image:: /dist/img/howto/hardcopy/print_dialog.jpg
    :alt:  印刷ダイアログ

:raw-html:`<kbd>:hardcopy</kbd>` ではなく、 :raw-html:`<kbd>!</kbd>` を付けて :raw-html:`<kbd>:hardcopy!</kbd>` とコマンドを入力した場合は、 |BR|
印刷ダイアログを経由せずに、いきなり印刷を実行します。

.. parsed-literal::
    :class: console

    **" 印刷ダイアログを表示しないで印刷**
    :hardcopy!



================================================================================
印刷範囲を指定する
================================================================================

:raw-html:`<kbd>:hardcopy</kbd>` コマンド実行時に、ビジュアルモードで範囲を選択するか、 |BR|
コマンドラインモードで範囲を指定すると、指定した範囲のみを印刷できます。

.. parsed-literal::
    :class: console

    **" 20行目から50行目を印刷する**
    :20,50hardcopy



================================================================================
印刷の設定
================================================================================

印刷結果をカスタマイズする
--------------------------------------------------------------------------------

印刷結果のカスタマイズは、vimエディタのオプションを設定することで実現します。

.. image:: /dist/img/howto/hardcopy/hardcopy_options_flow.png
    :alt:  印刷オプション設定、印刷のフロー
    :class: image-border

例えば、ヘッダーの印刷設定を変更するには「printheader」オプションを設定し、
その後に :raw-html:`<kbd>:hardcopy</kbd>` コマンドを実行します。

.. parsed-literal::
    :class: program

    **" ヘッダーの設定**
    :set printheader=%=Page\ %N
    
    **" 印刷実行**
    :hardcopy

すると、先ほど設定した「printheader」オプションの指定に従った印刷が行われます。

.. note::

    どのような印刷系オプションがあるかについては、
    他のページで説明します。


印刷用の設定ファイルを用意する
--------------------------------------------------------------------------------

印刷設定用のオプションは、
:raw-html:`<kbd>:hardcopy</kbd>` コマンド実行直前に手動でセットしても良いし、
vimエディタの設定ファイル内でセットしても構いません。 |BR|
しかし、前者の方法は毎回コマンドを実行するのが面倒ですし、
後者の方法も印刷設定を変更しようとすると手間がかかります。

そこで、印刷専用の設定ファイルを別に用意し、そのファイルに印刷のオプションを記述、 |BR|
:raw-html:`<kbd>:hardcopy</kbd>` コマンド実行前に :raw-html:`<kbd>:source</kbd>` コマンドで読み込む方法をおすすめします。 |BR|
この方法であれば、印刷をカスタマイズしたい場合は、印刷用設定ファイルを変更するだけで済みます。

.. parsed-literal::
    :class: console

    **" 印刷用設定ファイルを読み込み**
    :source $HOME/vimfiles/macros/printrc.vim
    
    **" それから印刷**
    :hardcopy

印刷用設定ファイルは、サンプルとなるファイルを用意しておいたので、参考にしてみてください。 |BR|
参考：
`vimエディタ 印刷用カスタム設定ファイル`__

__ http://indefero.taku-o.net/index.php/p/download/source/file/master/printrc.vim



================================================================================
2html.vimを使用して、Webブラウザで印刷する
================================================================================

2html.vimスクリプトを使用するとカレントビューそのままのHTMLファイルを生成できるので、 |BR|
vimエディタから直接印刷するのではなく、 |BR|
代わりに2html.vimスクリプトで生成したHTMLファイルをウェブブラウザで印刷する方法もあります。

.. parsed-literal::
    :class: console

    **" 2html.vimスクリプトで、テキストをHTML化**
    :TOhtml

2html.vimの詳しい使い方については、次のページを参照してください。 |BR|
参考：
`2html.vim : ファイルをシンタックスハイライトつきのHTMLに変換`__

__ /articles/vim/2html_vim.html



================================================================================
ページリンク
================================================================================

#. - `vimエディタの印刷機能を使用する #1 （印刷機能の基本）`__
#. `vimエディタの印刷機能を使用する #2 （ヘッダー、余白、改行位置の設定）`__
#. `vimエディタの印刷機能を使用する #3 （描画に関する設定）`__
#. `vimエディタの印刷機能を使用する #4 （プリンタ設定）`__

__ /articles/howto/hardcopy/hardcopy.html
__ /articles/howto/hardcopy/hardcopy_page.html
__ /articles/howto/hardcopy/hardcopy_draw.html
__ /articles/howto/hardcopy/hardcopy_printer.html



