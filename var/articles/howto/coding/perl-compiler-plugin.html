.. vim:set expandtab ff=unix ft=rest :

..  perl.vimコンパイラプラグインで、Perlコードをクィックフィックスする。

..  compilerディレクトリにあるperl.vimコンパイラプラグインを使うと、
    Perl言語で書かれたコードの文法チェックと、QuickFixリストを利用したコードの
    修正作業を手早く行えます。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

compilerディレクトリにあるperl.vimコンパイラプラグインを使うと、 |BR|
Perl言語で書かれたコードの文法チェックと、QuickFixリストを利用したコードの |BR|
修正作業を手早く行えます。



================================================================================
インストール方法
================================================================================

perl.vimコンパイラプラグインは、デフォルトでインストールされています。 |BR|
よって、perl.vimコンパイラプラグインのインストールの必要はありません。

ただし、perl.vimコンパイラプラグインを実行するにはPerl言語環境が必要なので、 |BR|
Perl言語環境が無い場合はインストール、および、PATHの設定を行ってください。

.. note::

    perlコマンドにパスを通す必要があります。



================================================================================
perl.vimコンパイラプラグインの使い方
================================================================================

perl.vimコンパイラプラグインの使い方は、
他のコンパイラプラグインと特に変わるところはありません。


コンパイラプラグインの設定
--------------------------------------------------------------------------------

最初に「:compiler」コマンドで「perl」コンパイラプラグインを設定します。 |BR|
「perl」コンパイラプラグインを設定するには、次のコマンドを実行してください。

.. parsed-literal::
    :class: console

    " コンパイラプラグインを設定する
    :compiler perl

.. image:: /dist/img/howto/coding/perl-compiler-plugin-compiler-perl.png
    :alt:  perlコンパイラプラグインを設定


シンタックスチェックの実行
--------------------------------------------------------------------------------

文法チェックを行いたいファイルを開いて「:make」コマンドを実行すると、
開いているファイルに対してシンタックスチェックを行います。 |BR|
その際、シンタックスエラーを見つけると、エラー結果はQuickFixリストに入れます。

.. parsed-literal::
    :class: console

    " 文法チェックを実行する
    :make

.. image:: /dist/img/howto/coding/perl-compiler-plugin-make.png
    :alt:  コンパイラプラグインを実行する


エラー発生箇所の確認
--------------------------------------------------------------------------------

QuickFixリストに入れられた文法エラーを確認するには、次のコマンドを実行します。

.. parsed-literal::
    :class: console

    " QuickFixリストのウィンドウを開く
    :cwidow

.. parsed-literal::
    :class: console

    " エラーの一覧を表示する
    :clist

.. image:: /dist/img/howto/coding/perl-compiler-plugin-clist.png
    :alt:  エラーを確認する。


文法エラーの発生した位置に移動する
--------------------------------------------------------------------------------

発生したエラーを簡単に修正できるように、
QuickFixリストに登録されたエラーの発生箇所へ移動するコマンドが用意されています。 |BR|
よく使われるコマンドとしては、次のようなコマンドがあります。

.. parsed-literal::
    :class: console

    " 次のエラー発生箇所に移動する
    :cnext

.. parsed-literal::
    :class: console

    " 前のエラー発生箇所に移動する（下2つのコマンドのどちらでも良い）
    :cprevious
    :cNext

.. parsed-literal::
    :class: console

    " 次のファイルのエラー発生箇所に移動する
    :cnfile

.. parsed-literal::
    :class: console

    " 前のファイルのエラー発生箇所に移動する（下2つのコマンドのどちらでも良い）
    :cpfile
    :cNfile


エラー番号を直接指定して、そのエラーの発生位置に移動するコマンドも用意されています。 |BR|
コマンドのフォーマットは次の通りで、コマンドのパラメータとして、エラーの番号を渡します。

.. parsed-literal::
    :class: console

    " コマンドのフォーマット
    " 指定したエラー番号の位置に移動する
    :cc {エラー番号}
    
    
    " コマンド例
    " エラー番号89の位置ににカーソルを移動する
    :cc 89

.. note::

    他にも便利なコマンドは用意されています。 |BR|
    詳しくはvimエディタの次のヘルプページを参照してください。

    .. parsed-literal::
        :class: console

        :help quickfix
        :help 30.1



================================================================================
ロケーションリスト
================================================================================

QuickFixリストの他に、ロケーションリストと呼ばれるエラー結果格納エリアがあり、
そちらを使用したクィックフィックスも行えます。 |BR|
QuickFixリストとロケーションリストの違いは、
ロケーションリストは分割したvimエディタのウィンドウごとに別々のリストデータを持てることで、 |BR|
この特徴は、複数のエラー結果を比較する時などに活かせるでしょう。

.. note::

    実際には、
    「:colder」という古いQuickFixリストをカレントにするコマンドがあるので、 |BR|
    ロケーションリストの使い方を知らなくても、それほど困ることはない。

    .. parsed-literal::
        :class: console

        :colder


ロケーションリストを利用する
--------------------------------------------------------------------------------

QuickFixリストの代わりに、ロケーションリストを利用するには、 |BR|
「:make」の代わりに「:lmake」を使用する、といったように、 |BR|
ロケーションリスト用に用意された専用コマンドを使用します。

.. parsed-literal::
    :class: console

    :lmake

.. image:: /dist/img/howto/coding/perl-compiler-plugin-lmake.png
    :alt:  ロケーションリストを利用する

.. csv-table:: 主なコマンドの一覧表
    :header: QuickFixリスト用, ロケーションリスト用, 説明

    :make      , :lmake     , コンパイラプラグインの処理を実行する。
    :cwidow    , :lwindow   , リストのウィンドウを開く
    :clist     , :llist     , エラーの一覧を表示する
    :cnext     , :cnext     , 次のエラー発生箇所に移動する
    :cprevious , :lprevious , 前のエラー発生箇所に移動する
    :cNext     , :lNext     , 前のエラー発生箇所に移動する
    :cnfile    , :lnfile    , 次のファイルのエラー発生箇所に移動する
    :cpfile    , :lpfile    , 前のファイルのエラー発生箇所に移動する
    :cNfile    , :lNfile    , 前のファイルのエラー発生箇所に移動する
    :cc        , :ll        , 指定したエラー番号の位置に移動する



================================================================================
注意事項など
================================================================================

コンパイラプラグインの挙動は、それぞれのプラグインごとに異なります。 |BR|
「:compiler」コマンドを引数なしで実行すると、
利用可能なコンパイラプラグインの一覧を表示できるので、 |BR|
他のコンパイラプラグインを利用する場合は、
この一覧で利用できるプラグインを確認してください。

.. parsed-literal::
    :class: console

    :compiler

.. image:: /dist/img/howto/coding/perl-compiler-plugin-compiler.png
    :alt:  コンパイラプラグインの一覧を表示






