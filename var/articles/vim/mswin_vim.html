.. vim:set expandtab ff=unix ft=rest :

..  mswin.vim : ウィンドウズアプリケーション風キーマッピングを使用できるようにする

..  mswin.vimスクリプトはvimエディタに標準添付されているスクリプトで、
    このスクリプトを読み込むと、
    「Ctrl-c」「Ctrl-p」によるコピー&ペースト、「Ctrl-s」によるファイル保存など、
    マイクロソフト ウィンドウズ風のキーマッピングをvimエディタで使用できます。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

mswin.vimスクリプトはvimエディタに標準添付されているスクリプトで、 |BR|
このスクリプトを読み込むと、
「Ctrl-c」「Ctrl-p」によるコピー&ペースト、「Ctrl-s」によるファイル保存など、 |BR|
マイクロソフト ウィンドウズ風のキーマッピングをvimエディタで使用できます。



================================================================================
インストール方法
================================================================================

mswin.vimスクリプトは標準添付されているスクリプトなので、
スクリプトを新たに入手する必要はありませんが、 |BR|
vimエディタがmswin.vimスクリプトを読み込むように設定する必要はあります。

mswin.vimスクリプトを使用するには、 |BR|
vimエディタ設定ファイルに次の設定を追加してください。

.. parsed-literal::
    :class: console

    :source $VIMRUNTIME/mswin.vim



================================================================================
使い方
================================================================================

mswin.vimスクリプトを読み込むと、ウィンドウズ風のキーマッピングを |BR|
vimエディタで使用できるようになります。

各コマンドは基本的に、vimエディタのモードがどの状態でも使用できます。 |BR|
例えば、入力モードであっても、「Ctrl-s」を押せばファイルを保存できます。

コピー、カットなど範囲の選択が必要となる操作は、 |BR|
ビジュアルモードで範囲を選択してから、
「Ctrl-c」や「Ctrl-x」による操作を行います。

.. image:: /dist/img/vim/mswin_select_and_copy.jpg
    :alt:  ビジュアルモードで選択してからコピー、カット

このスクリプトで定義されるコピー、カット、ペーストは、 |BR|
一般のアプリケーションと同様、クリップボードを経由してデータをやり取りします。


設定されるキーマッピング
-------------------------------------------------------------------------------

下の表はmswin.vimスクリプトで設定されるキーマッピングの表です。

.. csv-table::
    :header: キー, 機能のマッピング, 説明

    Ctrl-c, コピー, 選択したテキストをコピーする。コピーしたテキストはクリップボードに入ります。
    Ctrl-x, カット, 選択したテキストをカットする。消したテキストはクリップボードに入ります。
    Ctrl-v, ペースト, クリップボードのデータを貼り付けます。
    Ctrl-z, アンドゥ, 操作を一つ前に戻します。
    Ctrl-y, リドゥ, アンドゥで戻した操作を再実行します。
    Ctrl-s, 保存, ファイルを保存します。
    Ctrl-a, 全体選択, テキスト全てを選択します。
    Ctrl-q, 矩形選択, テキストを矩形選択します。
    Ctrl-Tab, ウィンドウの移動, 次のウィンドウにカーソルに移動します。
    Ctrl-F4, ウィンドウを閉じる, ウィンドウを閉じます。


矩形選択
-------------------------------------------------------------------------------

標準の「Cntr-v」による矩形選択は、クリップボードのデータのペースト操作に置き換えられてしまうので、 |BR|
代替となる矩形選択用のキーマッピング「Ctrl-q」が用意されているので、
矩形選択するときは、「Ctrl-q」を使用します。

.. image:: /dist/img/vim/mswin_square_select.jpg
    :alt:  <C-q>で矩形選択開始



================================================================================
注意事項など
================================================================================

mswin.vimスクリプトを使用すると、いくつかの機能で制限を受けます。

- 「:set guioptions+=a」で使用できる、ビジュアルモードで選択したテキストがクリップボードに入る機能が無効になります。
- 「Ctrl-a」による数字のインクリメント機能は、全選択のマッピングと置き換えられてしまいます。（使えなくなります。）



