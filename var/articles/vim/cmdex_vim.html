.. vim:set expandtab ff=unix ft=rest :

..  cmdex.vim : Kaoriyaパッチ ユーティリティコマンド集

..  cmdex.vimスクリプトはKaoriya版vimエディタに含まれるユーティリティコマンド定義スクリプトです。
    「:CdCurrent」「:VDsplit」「:Scratch」「:Transform」「:Tutorial」など、
    Kaoriya版に組み込まれている便利なコマンドのいくつかは、このcmdex.vimスクリプトで定義されています。
    Kaoriya版のvimエディタを使用しているなら、この記事は読んでおくべきです。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

cmdex.vimスクリプトはKaoriya版vimエディタに含まれるユーティリティコマンド定義スクリプトです。 |BR|
「:CdCurrent」「:VDsplit」「:Scratch」「:Transform」「:Tutorial」など、 |BR|
Kaoriya版に組み込まれている便利なコマンドのいくつかは、このcmdex.vimスクリプトで定義されています。 |BR|
Kaoriya版のvimエディタを使用しているなら、この記事は読んでおくべきです。



================================================================================
インストール方法
================================================================================

cmdex.vimスクリプトは、Kaoriyaパッチに添付されています。 |BR|
Kaoriyaパッチ入りのvimエディタを使用している場合は、 |BR|
既に使用可能な状態になっているため、インストール作業は必要ありません。



================================================================================
cmdex.vimにより使用できるようになるコマンド、マッピングの一覧
================================================================================

cmdex.vimスクリプトには、次の表のコマンド、キーマッピングが定義されています。

.. csv-table:: 追加されるコマンド
    :header: コマンド, 簡易説明

    `:Tutorial`_, vimエディタのチュートリアルを開始する。
    `:Scratch`_, 作業用バッファを作成する。
    `:CdCurrent`_, カレントディレクトリを、現在開いているファイルと同じディレクトリに変更する。
    `:Transform`_, perl言語のtr演算子のような置換処理を行う。
    `:VDsplit`_, 今開いているファイルと、指定したファイルとの差分表示を行う。
    `:Undiff`_, diffモードを終了させる。
    `:HTMLConvert`_, 見た目そのままのHTMLを生成し、拡張子.htmlを付けたファイルに出力する。
    `:Nohlsearch`_, 最後の検索ワード情報を消去する。「:nohlsearch」コマンドの強化版。
    `:IminsertOff`_, 入力モードに入った時に、インプットメソッド（日本語入力）をオフにする。
    `:IminsertOn`_, 「:IminsertOff」コマンドによって行われた変更を元に戻す。
    `:MenuLang`_, 指定した言語のメニューバー設定ファイルを読み込む。

.. _`:IminsertOff`: `:IminsertOn、:IminsertOff`_
.. _`:IminsertOn`: `:IminsertOn、:IminsertOff`_


.. csv-table:: 追加されるマッピング
    :header: マッピング, 使用できるモード, 簡易説明

    `Ctrlキーを押しながらx`_, コマンドラインモード, 今開いているファイルのディレクトリまでのパスを出力する。

.. _`Ctrlキーを押しながらx`: `コマンドラインモードで、Ctrl-x`_



================================================================================
各コマンドの使い方、説明
================================================================================

:Tutorial
--------------------------------------------------------------------------------

「:Tutorial」コマンドを実行すると、vimエディタのチュートリアルが開始されます。 |BR|
このコマンドはチュートリアルの原本のファイルを「TUTORCOPY」という名前でコピーし、
そのコピーファイルを使用してチュートリアルを行うので、 |BR|
「:Tutorial」コマンドでチュートリアルを開始した場合は、
チュートリアル中にファイルを変更しても何ら問題ありません。

参考：「 `チュートリアルでvimの使い方を覚えよう`__ 」

__ /articles/howto/tutorial.html

.. parsed-literal::
    :class: console

    **" vimエディタのチュートリアルを開始する。**
    :Tutorial

.. image:: /dist/img/vim/cmdex_tutorial.jpg
    :alt:  チュートリアルの開始



:Scratch
--------------------------------------------------------------------------------

「:Scratch」コマンドを実行すると、作業用の空のバッファを作成します。 |BR|
作業用バッファは一時的なメモや編集用のスペースとして利用できます。

.. parsed-literal::
    :class: console

    **" スクラッチバッファを開く。**
    :Scratch

.. image:: /dist/img/vim/cmdex_scratch.jpg
    :alt:  スクラッチバッファを開く



:CdCurrent
--------------------------------------------------------------------------------

「:CdCurrent」コマンドは、カレントディレクトリを今開いているファイルと
同じディレクトリに変更するコマンドです。 |BR|
ファイルを引数にとるコマンドを実行する時などに便利に利用できるコマンドです。

.. parsed-literal::
    :class: console

    **" カレントディレクトリをファイルと同じディレクトリにする。**
    :CdCurrent



:Transform
--------------------------------------------------------------------------------

「:Transform」コマンドを使用すると、perl言語のtr演算子のような処理を実行できます。 |BR|
このコマンドは引数として、変換対象の文字、変換後の文字の2つ受け取ります。

.. parsed-literal::
    :class: console

    **" A→x、B→y、C→zと対応する文字に置換します。**
    :Transform ABC xyz
    
    **" コマンド処理の範囲の指定を行わないと、カレント行にしか置換処理を行いません。**
    :%:Transform abcde xxyyz
    :20,40:Transform 12345 51234

.. note::

    .. image:: /dist/img/vim/cmdex_transform.jpg
        :alt:  :Transform変換の説明図

    左引数の1文字目が、右の引数1番目の文字に置換される。（ A → O ） |BR|
    左引数の2文字目が、右の引数2番目の文字に置換される。（ B → P ） |BR|
    左引数の3文字目が、右の引数3番目の文字に置換される。（ C → Q ） |BR|
    左引数の4文字目が、...



:VDsplit
--------------------------------------------------------------------------------

「:VDsplit」コマンドは今開いているファイルと指定したファイルとで差分比較を行うコマンドです。 |BR|
コマンドの引数として比較対象のファイルを受け取ります。

参考：「 `2つのテキストファイルの差分を取る`__ 」

__ /articles/howto/diff/diff_text.html

.. parsed-literal::
    :class: console

    **" カレントファイルと、'another.txt'とで比較を行う。**
    :VDsplit another.txt

.. image:: /dist/img/howto/diff/vertical_diff.jpg
    :alt:  :VDsplitコマンド実行後画面例



:Undiff
--------------------------------------------------------------------------------

「:Undiff」コマンドは、カレントウィンドウのdiffモードを解除するコマンドです。 |BR|
diffによる比較が終わった後に、元の状態に戻すのに使用できます。

.. parsed-literal::
    :class: console

    **" diffモードを解除する。**
    :Undiff

.. image:: /dist/img/vim/cmdex_undiff.jpg
    :alt:  diffモードの解除、図解。



:HTMLConvert
--------------------------------------------------------------------------------

「:HTMLConvert」コマンドを実行すると、今開いているファイルを見た目そのままの形式で
HTMLに変換し、 |BR|
「カレントファイルの名前 + .html」という名前のファイルに出力します。 |BR|
この機能は2html.vimスクリプトに用意されている機能です。

参考：「 `2html.vim : Transform a file into HTML, using the current syntax highlighting.`__ 」

__ /articles/vim/2html_vim.html

.. parsed-literal::
    :class: console

    **" HTMLを生成する。**
    :HTMLConvert

.. image:: /dist/img/vim/cmdex_htmlconvert.jpg
    :alt:  HTML変換後のビュー



:Nohlsearch
--------------------------------------------------------------------------------

「/」「?」による検索を行った後、「:nohlsearch」コマンドを実行すると
検索のハイライトを消去することが出来ますが、 |BR|
その状態でも「n」キーを押してしまうと、再び検索が始まり、
検索にマッチするテキストのハイライトが行われてしまいます。 |BR|
「:Nohlsearch」コマンドを使用すると、前回の検索テキストの記録を消去することができるので、
そのような事態を避けることができます。

.. parsed-literal::
    :class: console

    **" このコマンドは「:nohlsearch」コマンドの代替として使用できる。**
    :Nohlsearch



:IminsertOn、:IminsertOff
--------------------------------------------------------------------------------

「:IminsertOff」コマンドを実行すると、ノーマルモードなどから入力モードに入った時に、
必ず日本語入力がオフの状態から始まるようになります。 |BR|
（つまり、アスキー入力の状態から始まります。）

「:IminsertOn」コマンドは、その「:IminsertOff」コマンドと対になるコマンドで、 |BR|
「:IminsertOff」コマンドによって変更された状態をクリアし、初期の状態に戻すことができます。

.. parsed-literal::
    :class: console

    **" 入力モード開始時は日本語入力オフ。**
    :IminsertOff
    
    **" 「:IminsertOff」コマンドの変更をリセットする。**
    :IminsertOn



:MenuLang
--------------------------------------------------------------------------------

「:MenuLang」コマンドは、指定した言語のメニュー定義ファイルを読み込み、
メニューをロードしなおすコマンドです。 |BR|
次のコマンド例のように、メニューの言語を引数に取ります。

.. parsed-literal::
    :class: console

    **" 「:MenuLang」コマンドの使用例。**
    :MenuLang ja_jp.ujis
    :MenuLang en
    :MenuLang nl_NL.ISO_8859-1



================================================================================
マッピングの使い方、説明
================================================================================

コマンドラインモードで、Ctrl-x
--------------------------------------------------------------------------------

コマンドラインモードでCtrl-x (Ctrlキーを押しながらx)を押すと、
編集ファイルの親ディレクトリまでのパスが出力されます。

例えば、次のような状態で、

.. image:: /dist/img/vim/cmdex_cx1.jpg
    :alt:  入力前の状態

↓ Ctrl-xを入力すると、ファイルのあるディレクトリまでのパスが出力されます。

.. image:: /dist/img/vim/cmdex_cx2.jpg
    :alt:  Ctrl-x入力後



================================================================================
設定
================================================================================

cmdex.vimの使用を停止する。
--------------------------------------------------------------------------------

cmdex.vimスクリプトはvimエディタ起動時に読み込まれます。 |BR|
スクリプトで定義されたコマンド、マッピングが読み込まないようにするには、
次の設定をvimエディタの設定ファイルに追加してください。

.. parsed-literal::
    :class: program

    **" cmdex.vimスクリプトの読込を停止する。**
    :let plugin_cmdex_disable = 1



================================================================================
注意事項など
================================================================================

この記事は2008年1月7日に記述されました。 |BR|
今後、このcmdex.vimスクリプトファイルが変更され、
この記事どおりに行かない可能性がいくらかあります。





