.. vim:set expandtab ff=unix ft=rest :

..  Modeliner : 今の設定でモードラインを挿入、更新

..  modeliner.vimスクリプトは、vimエディタのモードラインを出力するスクリプトです。
    このスクリプトで定義される「:Modeliner」コマンドは、
    モードラインが定義されていればそのモードラインを更新し、
    なければモードラインの行を挿入します。
    (Windows, Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

Modeliner : Generates modeline according to the current settings. |BR|
http://www.vim.org/scripts/script.php?script_id=1477

modeliner.vimスクリプトは、vimエディタのモードラインを出力するスクリプトです。 |BR|
このスクリプトで定義される「:Modeliner」コマンドは、 |BR|
モードラインが定義されていればそのモードラインを更新し、
なければモードラインの行を挿入します。



================================================================================
インストール方法
================================================================================

`スクリプト`__ をダウンロードして、 |BR|
そのスクリプトをpluginディレクトリにコピーして下さい。

__ http://www.vim.org/scripts/script.php?script_id=1477

.. csv-table::
    :header: "ファイル", "URL"

    "modeliner.vim", "http://www.vim.org/scripts/script.php?script_id=1477"

スクリプトをインストールすると、 |BR|
「:Modeliner」コマンドを使用できるようになります。



================================================================================
「:Modeliner」コマンドの使い方
================================================================================

モードラインを入れたい場所で、次のコマンドを実行してください。

.. parsed-literal::
    :class: console

    :Modeliner

ファイルにモードラインが定義されていなければ、 |BR|
その位置に現在の設定情報を元にモードラインを挿入します。

.. image:: /dist/img/vim/modeliner_insert.jpg
    :alt:  モードラインの新規挿入

もし、モードラインがファイルで既に定義されているなら、
その定義済みのモードラインが更新されます。 |BR|
（既存のモードラインを上書きしてよいか聞かれるので、良ければ「Y」を押してください。）

.. image:: /dist/img/vim/modeliner_update.jpg
    :alt:  既存モードラインの更新

.. note::

    新規にモードラインを追加する場合は、モードラインの追加位置に注意してください。 |BR|
    vimエディタにモードラインを読み込ませるには、
    ファイルの上か下の端から、vimエディタの「modelines」オプション行の範囲に |BR|
    モードラインが定義されている必要があります。
    （デフォルト 5行）

    参考： `モードラインを使って、ファイルごとにvimエディタのオプションを指定する。`__

    __ /articles/howto/file/modeline.html



================================================================================
出力するモードラインのフォーマットの変更
================================================================================

出力するオプションのカスタマイズ
-------------------------------------------------------------------------------

モードラインで指定するオプションは「g:Modeliner_format」の設定で変更できます。 |BR|
「:Modeliner」コマンドで出力したいオプションを決定したら、 |BR|
vimエディタの設定ファイルに、下記の例のように設定を追加してください。

.. parsed-literal::
    :class: program

    **" 「g:Modeliner_format」の設定例**
    :let g:Modeliner_format = 'fenc= ts= sts= sw= autoindent et filetype='

- モードラインで出力したいオプションの名前を「g:Modeliner_format」で指定します。
- 数字型、文字型のオプションは、オプション名の後ろに「=」をつけます。
- ON、OFF型のオプションは、オプション名をそのまま書きます。
- 各オプション名の間は、スペースで区切ります。


コメントのフォーマット
-------------------------------------------------------------------------------

「:Modeliner」コマンドで生成されるモードラインは、
そのファイルタイプごとのコメント付きで出力されます。 |BR|
このコメントのフォーマットを変更したい、あるいは、自分の定義のコメントにしたい、
という方もいらっしゃるかもしれません。

.. image:: /dist/img/vim/modeliner_comment.jpg
    :alt:  モードラインはコメント内で出力される。

「:Modeliner」コマンドで生成する、モードラインのコメントのフォーマットを
最も簡単に変えるには、 |BR|
「&commentstring」の設定を変更すると良いでしょう。

.. parsed-literal::
    :class: program

    :let &commentstring='<!--%s-->'

「&commentstring」の設定の「%s」の部分がモードラインに置き換わります。

.. note::

    「:let &commentstring」以下の設定を、vimエディタの設定ファイルに直接書いてしまうと、 |BR|
    全てのファイルタイプで設定が変更されてしまうので、 |BR|
    そのファイルタイプでのみ有効になるように工夫する必要はあります。




================================================================================
注意事項など
================================================================================

このスクリプトは「現在の設定」にしたがってモードラインを出力するので、 |BR|
実際の使い方としては、 |BR|
新規に作成したファイルにモードライン入れる場合以外は、 |BR|
「:set」コマンドを使用してエディタの設定を、そのファイル用に変更してから、 |BR|
「:Modeliner」コマンドでモードラインを挿入することが多くなる、と思います。



