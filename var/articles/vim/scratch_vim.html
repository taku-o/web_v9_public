.. vim:set expandtab ff=unix ft=rest :

..  scratch utility : 自由に開閉できる作業用バッファ管理プラグイン

..  「scratch utility」はスクラッチバッファを作成するプラグインです。
    このプラグインで作成したスクラッチバッファは、
    vimエディタを終了するまでは何度でも開き直せるので、手軽な作業用領域として利用できます。
    (Windows)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

scratch utility : A simple utility to create scratch buffers |BR|
http://www.vim.org/script.php?script_id=389

「scratch utility」はスクラッチバッファを作成するプラグインです。 |BR|
このプラグインで作成したスクラッチバッファは、 |BR|
vimエディタを終了するまでは何度でも開き直せるので、手軽な作業用領域として利用できます。

.. image:: /dist/img/vim/scratch_vim_open_close.png
    :alt:  スクラッチバッファを閉じる、開く



================================================================================
インストール方法
================================================================================

`vim online`__ からスクリプトをダウンロードし、 |BR|
ユーザ設定ファイルディレクトリの「plugin」ディレクトリにコピーしてください。

__ http://www.vim.org/script.php?script_id=389

.. parsed-literal::
    :class: program

    **" Windows環境の場合のインストールディレクトリ**
    $HOME/vimfiles/plugin/
    
    **" Mac OSX環境の場合のインストールディレクトリ**
    $HOME/.vim/plugin/

.. csv-table::
    :header: "ファイル", "URL"

    "scratch.vim", "http://www.vim.org/script.php?script_id=389"



================================================================================
使用方法
================================================================================

マッピングからスクラッチバッファを開く
--------------------------------------------------------------------------------

スクラッチバッファを開くには「F8」キーを押します。
開いたスクラッチバッファを閉じるには、再度「F8」キーを押してください。 |BR|
「F8」キーは、ノーマルモード、入力モード、どちらかのモードで入力を受け付けます。

.. parsed-literal::
    :class: console

    <F8>

.. image:: /dist/img/vim/scratch_vim_open_close.png
    :alt:  スクラッチバッファを閉じる、開く


コマンドからスクラッチバッファを開く
--------------------------------------------------------------------------------

「F8」キーの代わりに次のコマンドを実行しても、スクラッチバッファを開閉できます。

.. parsed-literal::
    :class: console

    :Scratch

.. note::

    「:Scratch」コマンドと同じ名前のコマンドが `cmdex.vim`__ で定義されているので、 |BR|
    Kaoriya版vimエディタを使用している場合は、「:Scratch」コマンドを実行すると、
    `cmdex.vim`__ が用意するスクラッチバッファが開かれます。 |BR|
    `cmdex.vim`__ の「:Scratch」コマンドが読み込まれた場合も、「F8」キーのマッピングは使用できます。

    __ /articles/vim/cmdex_vim.html
    __ /articles/vim/cmdex_vim.html
    __ /articles/vim/cmdex_vim.html

    参考：
    `cmdex.vim : Kaoriyaパッチ ユーティリティコマンド集`__

    __ /articles/vim/cmdex_vim.html



================================================================================
プラグインの設定
================================================================================

マッピングを変更する
--------------------------------------------------------------------------------

スクラッチバッファを開閉するためのキーのマッピングを「F8」から、他のキーに変更するには、
次の例のようにvimエディタの設定ファイルに記述してください。 |BR|
設定例では「F11」キーをスクラッチバッファを開くためのキーとして定義しています。 |BR|
この設定を行うと、スクラッチバッファを開く「F8」キーのマッピングが設定されなくなります。

.. raw:: html

    <pre class="program literal-block">:nmap &lt;unique&gt; &lt;silent&gt; <span class="code_high">&lt;F11&gt;</span> &lt;Plug&gt;ShowScratchBuffer
    :imap &lt;unique&gt; &lt;silent&gt; <span class="code_high">&lt;F11&gt;</span> &lt;Plug&gt;InsShowScratchBuffer</pre>


マッピングを設定しない
--------------------------------------------------------------------------------

スクラッチバッファを開閉するキーをマッピングしたくない場合は、
次の設定をvimエディタの設定ファイルで記述してください。 |BR|
この場合、スクラッチバッファを開く時、「:Scratch」コマンドを使用することになります。

.. parsed-literal::
    :class: program

    **" スクラッチバッファを開くマッピングを定義しない**
    :let no_plugin_maps = 1


終了時、バックアップファイルにスクラッチバッファを書き出す
--------------------------------------------------------------------------------

スクラッチバッファに書き込んだテキストは、vimエディタ終了時に消えてしまいます。 |BR|
万が一の時のための保険を取りたいのなら、
「g:scratchBackupFile」変数にバックアップ先のファイルのパスを設定しておくと、
vimエディタ終了時にスクラッチバッファのテキストをファイルに出力します。 |BR|
もし、スクラッチバッファに大事な事柄を記述したままvimエディタを終了したとしても、
バックアップファイルから復元できます。

.. parsed-literal::
    :class: program

    **" 例1. ホームディレクトリのscratch.txtにバックアップする**
    :let g:scratchBackupFile=$HOME . "/scratch.txt"
    
    **" 例2. /tmp/scratch.txtにバックアップする**
    :let g:scratchBackupFile="/tmp/scratch.txt"



================================================================================
注意事項など
================================================================================

スクラッチバッファでもシンタックスハイライトを有効に
--------------------------------------------------------------------------------

もしかしたら、スクラッチバッファでは、vimエディタのシンタックスハイライトは
利かないと考えている人がいるかもしれません。 |BR|
しかし、自力でファイルタイプをセットしたり、

.. parsed-literal::
    :class: console

    **" ファイルタイプに「perl」をセット**
    :set filetype=perl

「:filetype detect」コマンドを実行すれば、
スクラッチバッファでもシンタックスハイライトを有効にできます。

.. parsed-literal::
    :class: console

    **" ファイルタイプを判定**
    :filetype detect

.. image:: /dist/img/vim/scratch_vim_syntax_highlight.jpg
    :alt:  スクラッチバッファでシンタックスハイライトを有効に

スクラッチバッファにはファイル名が無いので
（ファイル名からファイルタイプを判別できないので）、 |BR|
「:filetype detect」コマンドを使用したファイルタイプの判別は、
テキストの内容からファイルタイプが特定できる場合か、 |BR|
モードラインが定義されている場合に可能です。

参考：
`モードラインを使って、ファイルごとにvimエディタのオプションを指定する。`__

__ /articles/howto/file/modeline.html



