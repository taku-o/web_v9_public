.. vim:set expandtab ff=unix ft=rest :

..  textutil.vim : 拡張子rtf、rtfd、doc、wordmlのリッチテキストフォーマットファイルを読み書き

..  リッチテキストフォーマットのファイルをvimエディタで読み書きするためのプラグインです。
    拡張子rtf、rtfd、doc、wordmlのファイルをプレーンなテキストファイルとして読み込み、
    保存時に、エディタで編集したテキストをリッチテキストファイルとして書き出します。
    (Mac)

.. |BR| raw:: html

    <br />

.. |yen|    unicode:: U+000A5 .. YEN SIGN

.. role:: raw-html(raw)
    :format: html

.. contents::

================================================================================
概要
================================================================================

textutil.vim : Vim plugin for editing rtf,rtfd,doc,wordml files. |BR|
http://www.vim.org/scripts/script.php?script_id=1432

リッチテキストフォーマットのファイルをvimエディタで読み書きするためのプラグインです。

拡張子rtf、rtfd、doc、wordmlのファイルをプレーンなテキストファイルとして読み込み、 |BR|
保存時に、エディタで編集したテキストをリッチテキストファイルとして書き出します。

このスクリプトは、ファイルフォーマットの変換にtextutilコマンドを利用しているので、 |BR|
Mac OSX 10.4か、それ以降のバージョンでないと動作しません。



================================================================================
インストール方法
================================================================================

`スクリプト`__ をダウンロードして、 |BR|
pluginディレクトリにコピーしてください。

__ http://www.vim.org/scripts/script.php?script_id=1432

なるべく「g:textutil_txt_encoding」を設定すること。 |BR|
詳しくは、この後の設定の項を参照してください。

.. csv-table::
    :header: ファイル, URL

    textutil.vim, http://www.vim.org/scripts/script.php?script_id=1432



================================================================================
使用方法
================================================================================

このスクリプトをインストールすると、 |BR|
拡張子がrtf、rtfd、doc、wordmlのファイルを開く時、あるいは、保存する時に、 |BR|
ファイルフォーマットの変換処理を自動的に実行するようになります。



================================================================================
設定
================================================================================

「g:textutil_txt_encoding」をvimエディタの設定ファイルで設定しておくと、 |BR|
リッチテキストファイルをプレーンなテキストに変換する際に、 |BR|
そのエンコーディングが使用されます。

今のバージョンでは、文字化けが発生したとしても、 |BR|
エンコーディングを指定してファイルを開き直すことができないため、 |BR|
「g:textutil_txt_encoding」の指定は必須です。

.. parsed-literal::
    :class: program

    :let g:textutil_txt_encoding=エンコーディング

.. parsed-literal::
    :class: program

    **" 設定例。このような設定を設定ファイルに書く。**
    :let g:textutil_txt_encoding='Shift_JIS'



================================================================================
注意事項など
================================================================================

ファイルの変換処理を行うかどうかは拡張子で判断しているため、 |BR|
拡張子がdocのテキストファイルを保存すると、変換処理が実行されてしまいます。

このプラグインをインストールしたvimエディタでリッチテキストフォーマットのファイルを編集すると |BR|
ファイルのプロパティ、フォント、テキストの配置などの情報が消失します。

このスクリプトは、ファイルフォーマットの変換にtextutilコマンドを利用しているので、 |BR|
Mac OSX 10.4か、それ以降のバージョンでないと動作しません。



